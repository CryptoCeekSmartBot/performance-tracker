<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Performance Tracker Pro | Corporate Analytics Dashboard</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@500&display=swap" rel="stylesheet">
  <style>
    * { font-family: 'Inter', sans-serif; }
    .mono { font-family: 'JetBrains Mono', monospace; }
    ::-webkit-scrollbar { width: 8px; height: 8px; }
    ::-webkit-scrollbar-track { background: #1e293b; }
    ::-webkit-scrollbar-thumb { background: #475569; border-radius: 4px; }
    ::-webkit-scrollbar-thumb:hover { background: #64748b; }
    .light-mode::-webkit-scrollbar-track { background: #e2e8f0; }
    .light-mode::-webkit-scrollbar-thumb { background: #94a3b8; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
    @keyframes slideIn { from { opacity: 0; transform: translateX(20px); } to { opacity: 1; transform: translateX(0); } }
    .animate-fade-in { animation: fadeIn 0.5s ease-out forwards; }
    .animate-slide-in { animation: slideIn 0.3s ease-out forwards; }
    .animate-pulse-slow { animation: pulse 2s ease-in-out infinite; }
    .gradient-text { background: linear-gradient(135deg, #06b6d4, #3b82f6, #8b5cf6); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
    .cell-green { background: linear-gradient(135deg, #059669, #10b981); }
    .cell-yellow { background: linear-gradient(135deg, #d97706, #f59e0b); }
    .cell-red { background: linear-gradient(135deg, #dc2626, #ef4444); }
    .cell-holiday { background: linear-gradient(135deg, #475569, #64748b); }
    .glass { backdrop-filter: blur(10px); }
    .modal-overlay { background: rgba(0,0,0,0.7); backdrop-filter: blur(4px); }
    @media print {
      .no-print { display: none !important; }
      body { background: white !important; }
    }
  </style>
</head>
<body class="bg-slate-950 text-gray-100 min-h-screen">
  <div id="app">
    <!-- Upload Screen -->
    <div id="upload-screen" class="min-h-screen flex items-center justify-center p-4">
      <div class="max-w-2xl w-full animate-fade-in">
        <div class="text-center mb-8">
          <h1 class="text-4xl md:text-5xl font-bold gradient-text mb-3">Performance Tracker Pro</h1>
          <p class="text-gray-400 text-lg">Corporate Employee Performance Analytics</p>
        </div>
        
        <div id="drop-zone" class="bg-slate-900 border-2 border-dashed border-slate-700 rounded-2xl p-12 md:p-16 text-center cursor-pointer transition-all duration-300 hover:border-cyan-500 hover:bg-cyan-500/5">
          <div class="mb-6">
            <div class="w-20 h-20 mx-auto rounded-2xl bg-gradient-to-br from-cyan-500 to-blue-600 flex items-center justify-center mb-4 shadow-lg shadow-cyan-500/25">
              <svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/>
              </svg>
            </div>
            <h3 class="text-xl font-semibold text-white mb-2">Drop Excel File Here</h3>
            <p class="text-gray-400">or click to browse</p>
          </div>
          
          <input type="file" id="file-input" accept=".xls,.xlsx" class="hidden">
          
          <div class="flex items-center justify-center gap-2 text-gray-500 text-sm">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
            </svg>
            Supports .xls and .xlsx files
          </div>
        </div>
        
        <!-- Holiday Manager Button on Upload Screen -->
        <div class="mt-6 text-center">
          <button id="manage-holidays-btn-upload" class="px-6 py-3 bg-slate-800 hover:bg-slate-700 border border-slate-700 rounded-xl text-sm font-medium transition-all">
            üìÖ Manage Holidays Before Upload
          </button>
          <p class="text-gray-500 text-xs mt-2">Sundays auto-excluded ‚Ä¢ Add company holidays</p>
        </div>
        
        <div class="mt-8 grid grid-cols-3 gap-4 text-center">
          <div class="bg-slate-900 border border-slate-800 rounded-xl p-4">
            <div class="text-2xl mb-2">üìä</div>
            <div class="text-sm text-gray-400">Real-time Analytics</div>
          </div>
          <div class="bg-slate-900 border border-slate-800 rounded-xl p-4">
            <div class="text-2xl mb-2">üéØ</div>
            <div class="text-sm text-gray-400">Target Tracking</div>
          </div>
          <div class="bg-slate-900 border border-slate-800 rounded-xl p-4">
            <div class="text-2xl mb-2">üìÖ</div>
            <div class="text-sm text-gray-400">Holiday Manager</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Dashboard -->
    <div id="dashboard" class="hidden">
      <!-- Header -->
      <header class="bg-slate-900/95 border-b border-slate-800 sticky top-0 z-40 glass no-print">
        <div class="max-w-[1920px] mx-auto px-4 py-3">
          <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4">
            <div class="flex items-center gap-4 flex-wrap">
              <h1 class="text-xl font-bold gradient-text">Performance Tracker Pro</h1>
              <span id="report-date-badge" class="px-3 py-1 rounded-full text-xs font-medium bg-slate-800 text-gray-300"></span>
              <span id="working-days-badge" class="px-3 py-1 rounded-full text-xs font-medium bg-emerald-900/50 text-emerald-400"></span>
            </div>
            
            <div class="flex flex-wrap items-center gap-3">
              <div class="relative">
                <svg class="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                </svg>
                <input type="text" id="search-input" placeholder="Search employee..." class="bg-slate-800 border border-slate-700 text-gray-100 pl-10 pr-4 py-2 rounded-lg text-sm w-48 focus:outline-none focus:ring-2 focus:ring-cyan-500">
              </div>
              
              <select id="filter-select" class="bg-slate-800 border border-slate-700 text-gray-100 px-3 py-2 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-cyan-500">
                <option value="all">All Status</option>
                <option value="ontrack">‚úÖ On Track</option>
                <option value="atrisk">‚ö†Ô∏è At Risk</option>
                <option value="critical">üî¥ Critical</option>
                <option value="star">‚≠ê Stars</option>
              </select>
              
              <button id="manage-holidays-btn" class="px-3 py-2 rounded-lg hover:bg-slate-800 border border-slate-700 text-sm" title="Manage Holidays">üìÖ Holidays</button>
              <button id="theme-toggle" class="p-2 rounded-lg hover:bg-slate-800 border border-slate-700" title="Toggle theme">‚òÄÔ∏è</button>
              <button id="fullscreen-toggle" class="p-2 rounded-lg hover:bg-slate-800 border border-slate-700" title="Fullscreen">‚õ∂</button>
              <button id="print-btn" class="p-2 rounded-lg hover:bg-slate-800 border border-slate-700" title="Print">üñ®Ô∏è</button>
              <button id="new-upload-btn" class="p-2 rounded-lg hover:bg-slate-800 border border-slate-700" title="New Upload">üì§</button>
            </div>
          </div>
        </div>
      </header>

      <main class="max-w-[1920px] mx-auto p-4 space-y-6">
        <!-- Summary Cards -->
        <div id="summary-cards" class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-4"></div>

        <!-- Champion & Leaderboard -->
        <div class="grid lg:grid-cols-3 gap-4">
          <div id="champion-card" class="bg-gradient-to-br from-amber-900/30 to-yellow-900/20 border border-slate-800 rounded-xl p-6"></div>
          <div id="leaderboard-card" class="bg-slate-900 border border-slate-800 rounded-xl p-4 lg:col-span-2"></div>
        </div>

        <!-- Color Legend -->
        <div class="bg-slate-900 border border-slate-800 rounded-xl p-4">
          <div class="flex flex-wrap items-center gap-6 justify-center text-sm">
            <div class="flex items-center gap-2">
              <span class="font-semibold">Target 8:</span>
              <div class="flex items-center gap-1"><div class="w-4 h-4 rounded cell-green"></div><span class="text-xs">‚â•8</span></div>
              <div class="flex items-center gap-1"><div class="w-4 h-4 rounded cell-yellow"></div><span class="text-xs">6-7</span></div>
              <div class="flex items-center gap-1"><div class="w-4 h-4 rounded cell-red"></div><span class="text-xs">&lt;6</span></div>
            </div>
            <div class="w-px h-6 bg-slate-700"></div>
            <div class="flex items-center gap-2">
              <span class="font-semibold">Target 10:</span>
              <div class="flex items-center gap-1"><div class="w-4 h-4 rounded cell-green"></div><span class="text-xs">‚â•10</span></div>
              <div class="flex items-center gap-1"><div class="w-4 h-4 rounded cell-yellow"></div><span class="text-xs">8-9</span></div>
              <div class="flex items-center gap-1"><div class="w-4 h-4 rounded cell-red"></div><span class="text-xs">&lt;8</span></div>
            </div>
            <div class="w-px h-6 bg-slate-700"></div>
            <div class="flex items-center gap-2">
              <div class="flex items-center gap-1"><div class="w-4 h-4 rounded cell-holiday"></div><span class="text-xs font-bold">H</span></div>
              <span class="text-xs text-gray-400">= Sunday / Holiday</span>
            </div>
            <div class="w-px h-6 bg-slate-700"></div>
            <div class="flex items-center gap-3 text-xs text-gray-400">
              <span class="text-emerald-400">‚Üë Improving</span>
              <span>‚Üí Stable</span>
              <span class="text-red-400">‚Üì Declining</span>
            </div>
          </div>
        </div>

        <!-- Main Table -->
        <div class="bg-slate-900 border border-slate-800 rounded-xl overflow-hidden">
          <div class="overflow-x-auto">
            <table id="main-table" class="w-full text-sm">
              <thead id="table-header" class="bg-slate-800 sticky top-0"></thead>
              <tbody id="table-body"></tbody>
            </table>
          </div>
        </div>

        <!-- Footer Stats -->
        <div id="footer-stats" class="grid md:grid-cols-3 gap-4"></div>

        <!-- Footer -->
        <div class="text-center text-gray-500 text-sm py-4">
          Performance Tracker Pro ‚Ä¢ Corporate Analytics Dashboard
        </div>
      </main>
    </div>

    <!-- Holiday Manager Modal -->
    <div id="holiday-modal" class="fixed inset-0 z-50 hidden">
      <div class="modal-overlay absolute inset-0" id="modal-overlay"></div>
      <div class="relative z-10 flex items-center justify-center min-h-screen p-4">
        <div class="bg-slate-900 border border-slate-700 rounded-2xl w-full max-w-2xl max-h-[80vh] overflow-hidden animate-slide-in">
          <!-- Modal Header -->
          <div class="px-6 py-4 border-b border-slate-700 flex items-center justify-between">
            <div>
              <h2 class="text-xl font-bold">üìÖ Holiday Manager</h2>
              <p class="text-sm text-gray-400">Sundays auto-excluded ‚Ä¢ Add company holidays below</p>
            </div>
            <button id="close-modal-btn" class="p-2 hover:bg-slate-800 rounded-lg text-gray-400 hover:text-white">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
              </svg>
            </button>
          </div>
          
          <!-- Add Holiday Form -->
          <div class="px-6 py-4 border-b border-slate-700 bg-slate-800/50">
            <div class="flex flex-col sm:flex-row gap-3">
              <div class="flex-1">
                <label class="block text-xs text-gray-400 mb-1">Date</label>
                <input type="date" id="holiday-date" class="w-full bg-slate-800 border border-slate-600 text-gray-100 px-3 py-2 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-cyan-500">
              </div>
              <div class="flex-1">
                <label class="block text-xs text-gray-400 mb-1">Holiday Name</label>
                <input type="text" id="holiday-name" placeholder="e.g., Republic Day" class="w-full bg-slate-800 border border-slate-600 text-gray-100 px-3 py-2 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-cyan-500">
              </div>
              <div class="flex items-end">
                <button id="add-holiday-btn" class="px-4 py-2 bg-cyan-600 hover:bg-cyan-500 text-white rounded-lg text-sm font-medium transition-all">
                  ‚ûï Add
                </button>
              </div>
            </div>
          </div>
          
          <!-- Holiday List -->
          <div class="px-6 py-4 overflow-y-auto max-h-[40vh]">
            <div class="flex items-center justify-between mb-3">
              <h3 class="font-semibold text-sm text-gray-300">Holiday List (2026)</h3>
              <button id="reset-holidays-btn" class="text-xs text-amber-400 hover:text-amber-300">Reset to Default</button>
            </div>
            <div id="holiday-list" class="space-y-2"></div>
          </div>
          
          <!-- Modal Footer -->
          <div class="px-6 py-4 border-t border-slate-700 bg-slate-800/50 flex justify-between items-center">
            <div class="text-sm text-gray-400">
              <span id="holiday-count">0</span> holidays configured
            </div>
            <button id="save-holidays-btn" class="px-6 py-2 bg-emerald-600 hover:bg-emerald-500 text-white rounded-lg text-sm font-medium transition-all">
              ‚úÖ Save & Apply
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Global state
    let appData = null;
    let darkMode = true;
    let searchTerm = '';
    let filterStatus = 'all';
    let sortConfig = { key: null, direction: 'asc' };
    
    // Holiday Management - MCC 2026 Holidays Pre-loaded
    const DEFAULT_HOLIDAYS_2026 = [
      { date: '2026-01-26', name: 'Republic Day' },
      { date: '2026-03-03', name: 'Dol Jatra / Holi' },
      { date: '2026-05-01', name: 'May Day' },
      { date: '2026-06-26', name: 'Muharram' },
      { date: '2026-07-16', name: 'Rathayatra' },
      { date: '2026-10-19', name: 'Durga Puja' },
      { date: '2026-10-20', name: 'Durga Puja' },
      { date: '2026-10-21', name: 'Durga Puja' },
      { date: '2026-11-09', name: 'Kali Puja / Diwali' },
      { date: '2026-12-25', name: 'Christmas Day' }
    ];
    
    let holidays = [];

    // DOM Elements
    const uploadScreen = document.getElementById('upload-screen');
    const dashboard = document.getElementById('dashboard');
    const dropZone = document.getElementById('drop-zone');
    const fileInput = document.getElementById('file-input');
    const searchInput = document.getElementById('search-input');
    const filterSelect = document.getElementById('filter-select');
    const holidayModal = document.getElementById('holiday-modal');

    // Initialize
    document.addEventListener('DOMContentLoaded', () => {
      loadHolidays();
      setupEventListeners();
    });

    // Holiday Storage Functions
    function loadHolidays() {
      const stored = localStorage.getItem('performanceTrackerHolidays');
      if (stored) {
        holidays = JSON.parse(stored);
      } else {
        holidays = [...DEFAULT_HOLIDAYS_2026];
        saveHolidays();
      }
    }

    function saveHolidays() {
      localStorage.setItem('performanceTrackerHolidays', JSON.stringify(holidays));
    }

    function resetHolidays() {
      holidays = [...DEFAULT_HOLIDAYS_2026];
      saveHolidays();
      renderHolidayList();
    }

    function addHoliday(date, name) {
      if (!date || !name) return false;
      if (holidays.some(h => h.date === date)) {
        alert('Holiday already exists for this date!');
        return false;
      }
      holidays.push({ date, name });
      holidays.sort((a, b) => a.date.localeCompare(b.date));
      saveHolidays();
      return true;
    }

    function removeHoliday(date) {
      holidays = holidays.filter(h => h.date !== date);
      saveHolidays();
    }

    // Check if a day is a holiday or Sunday
    function isHoliday(year, month, day) {
      const dateStr = `${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
      return holidays.some(h => h.date === dateStr);
    }

    function isSunday(year, month, day) {
      const date = new Date(year, month - 1, day);
      return date.getDay() === 0;
    }

    function isNonWorkingDay(year, month, day) {
      return isSunday(year, month, day) || isHoliday(year, month, day);
    }

    function getWorkingDays(year, month, upToDay) {
      let count = 0;
      for (let d = 1; d <= upToDay; d++) {
        if (!isNonWorkingDay(year, month, d)) {
          count++;
        }
      }
      return count;
    }

    function getNonWorkingDaysCount(year, month, upToDay) {
      let sundays = 0;
      let holidayCount = 0;
      for (let d = 1; d <= upToDay; d++) {
        if (isSunday(year, month, d)) {
          sundays++;
        } else if (isHoliday(year, month, d)) {
          holidayCount++;
        }
      }
      return { sundays, holidays: holidayCount, total: sundays + holidayCount };
    }

    function setupEventListeners() {
      // File upload
      dropZone.addEventListener('click', () => fileInput.click());
      dropZone.addEventListener('dragover', (e) => {
        e.preventDefault();
        dropZone.classList.add('border-cyan-500', 'bg-cyan-500/10');
      });
      dropZone.addEventListener('dragleave', () => {
        dropZone.classList.remove('border-cyan-500', 'bg-cyan-500/10');
      });
      dropZone.addEventListener('drop', handleDrop);
      fileInput.addEventListener('change', handleFileSelect);

      // Controls
      searchInput.addEventListener('input', (e) => {
        searchTerm = e.target.value;
        renderTable();
      });
      filterSelect.addEventListener('change', (e) => {
        filterStatus = e.target.value;
        renderTable();
      });
      document.getElementById('theme-toggle').addEventListener('click', toggleTheme);
      document.getElementById('fullscreen-toggle').addEventListener('click', toggleFullscreen);
      document.getElementById('print-btn').addEventListener('click', () => window.print());
      document.getElementById('new-upload-btn').addEventListener('click', resetApp);

      // Holiday Modal
      document.getElementById('manage-holidays-btn-upload').addEventListener('click', openHolidayModal);
      document.getElementById('manage-holidays-btn').addEventListener('click', openHolidayModal);
      document.getElementById('close-modal-btn').addEventListener('click', closeHolidayModal);
      document.getElementById('modal-overlay').addEventListener('click', closeHolidayModal);
      document.getElementById('add-holiday-btn').addEventListener('click', handleAddHoliday);
      document.getElementById('reset-holidays-btn').addEventListener('click', resetHolidays);
      document.getElementById('save-holidays-btn').addEventListener('click', handleSaveHolidays);
      
      document.getElementById('holiday-name').addEventListener('keypress', (e) => {
        if (e.key === 'Enter') handleAddHoliday();
      });
    }

    function openHolidayModal() {
      holidayModal.classList.remove('hidden');
      renderHolidayList();
      document.body.style.overflow = 'hidden';
    }

    function closeHolidayModal() {
      holidayModal.classList.add('hidden');
      document.body.style.overflow = '';
    }

    function renderHolidayList() {
      const container = document.getElementById('holiday-list');
      if (holidays.length === 0) {
        container.innerHTML = '<p class="text-gray-500 text-sm text-center py-4">No holidays added</p>';
      } else {
        container.innerHTML = holidays.map(h => {
          const date = new Date(h.date + 'T00:00:00');
          const dayName = date.toLocaleDateString('en-US', { weekday: 'short' });
          const formattedDate = date.toLocaleDateString('en-US', { day: 'numeric', month: 'short', year: 'numeric' });
          return `
            <div class="flex items-center justify-between p-3 bg-slate-800 rounded-lg group">
              <div class="flex items-center gap-3">
                <div class="w-10 h-10 rounded-lg bg-slate-700 flex items-center justify-center text-xs font-bold text-cyan-400">
                  ${dayName}
                </div>
                <div>
                  <div class="font-medium text-sm">${h.name}</div>
                  <div class="text-xs text-gray-400">${formattedDate}</div>
                </div>
              </div>
              <button onclick="handleRemoveHoliday('${h.date}')" class="p-2 text-gray-500 hover:text-red-400 hover:bg-red-400/10 rounded-lg transition-all opacity-0 group-hover:opacity-100">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                </svg>
              </button>
            </div>
          `;
        }).join('');
      }
      document.getElementById('holiday-count').textContent = holidays.length;
    }

    function handleAddHoliday() {
      const dateInput = document.getElementById('holiday-date');
      const nameInput = document.getElementById('holiday-name');
      
      if (addHoliday(dateInput.value, nameInput.value.trim())) {
        dateInput.value = '';
        nameInput.value = '';
        renderHolidayList();
      }
    }

    function handleRemoveHoliday(date) {
      removeHoliday(date);
      renderHolidayList();
    }

    function handleSaveHolidays() {
      saveHolidays();
      closeHolidayModal();
      if (appData) {
        processDataWithHolidays();
      }
    }

    function handleDrop(e) {
      e.preventDefault();
      dropZone.classList.remove('border-cyan-500', 'bg-cyan-500/10');
      const file = e.dataTransfer.files[0];
      if (file && (file.name.endsWith('.xls') || file.name.endsWith('.xlsx'))) {
        parseExcel(file);
      } else {
        alert('Please upload a valid Excel file (.xls or .xlsx)');
      }
    }

    function handleFileSelect(e) {
      const file = e.target.files[0];
      if (file) parseExcel(file);
    }

    function parseExcel(file) {
      const reader = new FileReader();
      reader.onload = (e) => {
        try {
          const workbook = XLSX.read(e.target.result, { type: 'array' });
          const sheet = workbook.Sheets[workbook.SheetNames[0]];
          const jsonData = XLSX.utils.sheet_to_json(sheet, { header: 1 });
          processData(jsonData);
        } catch (error) {
          alert('Error parsing Excel file. Please check the format.');
          console.error(error);
        }
      };
      reader.readAsArrayBuffer(file);
    }

    function processData(jsonData) {
      const reportDateStr = jsonData[0]?.[0] || '';
      const dateMatch = reportDateStr.match(/(\d{2})\/(\d{2})\/(\d{4})/);
      const currentDay = dateMatch ? parseInt(dateMatch[1]) : 13;
      const currentMonth = dateMatch ? parseInt(dateMatch[2]) : 1;
      const currentYear = dateMatch ? parseInt(dateMatch[3]) : 2026;

      const workingDays = getWorkingDays(currentYear, currentMonth, currentDay);
      const nonWorkingInfo = getNonWorkingDaysCount(currentYear, currentMonth, currentDay);

      const employees = [];
      for (let i = 4; i < jsonData.length - 2; i++) {
        const row = jsonData[i];
        if (!row || !row[1]) continue;

        const decoName = row[1]?.toString() || '';
        const prMatch = decoName.match(/\(PR\d+\)/);
        if (!prMatch) continue;

        const dailyTarget = parseInt(row[6]) || 8;
        const retailPending = parseInt(row[2]) || 0;
        const imagesDone = parseInt(row[3]) || 0;
        const prolinksPending = parseInt(row[4]) || 0;
        const svgPending = parseInt(row[5]) || 0;

        const dailyData = [];
        let totalDone = 0;
        let totalRetail = 0, totalProlinks = 0, totalSvg = 0;

        for (let day = 1; day <= 31; day++) {
          const baseCol = 7 + (day - 1) * 3;
          const retail = parseInt(row[baseCol]) || 0;
          const prolinks = parseInt(row[baseCol + 1]) || 0;
          const svg = parseInt(row[baseCol + 2]) || 0;
          const total = retail + prolinks + svg;
          const isNonWorking = isNonWorkingDay(currentYear, currentMonth, day);
          const isSun = isSunday(currentYear, currentMonth, day);
          const isHol = isHoliday(currentYear, currentMonth, day);

          dailyData.push({ 
            day, retail, prolinks, svg, total, 
            isActive: day <= currentDay,
            isNonWorking, isSunday: isSun, isHoliday: isHol
          });

          if (day <= currentDay && !isNonWorking) {
            totalDone += total;
            totalRetail += retail;
            totalProlinks += prolinks;
            totalSvg += svg;
          }
        }

        const targetRequired = dailyTarget * workingDays;
        const shortfall = Math.max(0, targetRequired - totalDone);
        const achievementPct = targetRequired > 0 ? (totalDone / targetRequired * 100) : 0;

        const workingDaysData = dailyData.filter(d => d.isActive && !d.isNonWorking);
        const last5Days = workingDaysData.slice(-5);
        const trend = calculateTrend(last5Days);
        const alerts = calculateAlerts(dailyData, dailyTarget, currentDay, achievementPct, currentYear, currentMonth);

        employees.push({
          name: decoName.replace(/\s*\(PR\d+\)/, '').trim(),
          id: prMatch[0],
          fullName: decoName,
          dailyTarget, dailyData, totalDone, totalRetail, totalProlinks, totalSvg,
          targetRequired, shortfall, achievementPct,
          retailPending, prolinksPending, svgPending,
          totalPending: retailPending + prolinksPending + svgPending,
          trend, alerts, imagesDone
        });
      }

      const sortedByAchievement = [...employees].sort((a, b) => b.achievementPct - a.achievementPct);

      appData = {
        employees, currentDay, currentMonth, currentYear,
        reportDate: `${currentDay}/${String(currentMonth).padStart(2, '0')}/${currentYear}`,
        workingDays, nonWorkingInfo,
        leaderboard: sortedByAchievement.slice(0, 10),
        champion: sortedByAchievement[0],
        teamStats: calculateTeamStats(employees, workingDays, currentDay, nonWorkingInfo)
      };

      showDashboard();
    }

    function processDataWithHolidays() {
      const workingDays = getWorkingDays(appData.currentYear, appData.currentMonth, appData.currentDay);
      const nonWorkingInfo = getNonWorkingDaysCount(appData.currentYear, appData.currentMonth, appData.currentDay);
      
      appData.employees.forEach(emp => {
        emp.dailyData.forEach(day => {
          day.isNonWorking = isNonWorkingDay(appData.currentYear, appData.currentMonth, day.day);
          day.isSunday = isSunday(appData.currentYear, appData.currentMonth, day.day);
          day.isHoliday = isHoliday(appData.currentYear, appData.currentMonth, day.day);
        });
        
        let totalDone = 0, totalRetail = 0, totalProlinks = 0, totalSvg = 0;
        emp.dailyData.forEach(day => {
          if (day.isActive && !day.isNonWorking) {
            totalDone += day.total;
            totalRetail += day.retail;
            totalProlinks += day.prolinks;
            totalSvg += day.svg;
          }
        });
        
        emp.totalDone = totalDone;
        emp.totalRetail = totalRetail;
        emp.totalProlinks = totalProlinks;
        emp.totalSvg = totalSvg;
        emp.targetRequired = emp.dailyTarget * workingDays;
        emp.shortfall = Math.max(0, emp.targetRequired - totalDone);
        emp.achievementPct = emp.targetRequired > 0 ? (totalDone / emp.targetRequired * 100) : 0;
      });
      
      const sortedByAchievement = [...appData.employees].sort((a, b) => b.achievementPct - a.achievementPct);
      appData.workingDays = workingDays;
      appData.nonWorkingInfo = nonWorkingInfo;
      appData.leaderboard = sortedByAchievement.slice(0, 10);
      appData.champion = sortedByAchievement[0];
      appData.teamStats = calculateTeamStats(appData.employees, workingDays, appData.currentDay, nonWorkingInfo);
      
      renderDashboard();
    }

    function calculateTrend(last5Days) {
      if (last5Days.length < 2) return 'stable';
      const recent = last5Days.slice(-2).reduce((a, b) => a + b.total, 0) / 2;
      const earlier = last5Days.slice(0, 2).reduce((a, b) => a + b.total, 0) / 2;
      const diff = recent - earlier;
      if (diff > 1) return 'up';
      if (diff < -1) return 'down';
      return 'stable';
    }

    function calculateAlerts(dailyData, target, currentDay, achievementPct, year, month) {
      const alerts = [];
      const activeDays = dailyData.filter(d => d.isActive && !d.isNonWorking);
      const last3 = activeDays.slice(-3);
      const threshold = target === 10 ? 8 : 6;

      if (last3.length === 3 && last3.every(d => d.total < threshold)) {
        alerts.push({ type: 'critical', message: '3+ days below target' });
      }
      if (achievementPct < 80 && activeDays.length > 5) {
        alerts.push({ type: 'warning', message: 'At risk of missing target' });
      }
      const today = activeDays[activeDays.length - 1];
      if (today && today.total === 0) {
        alerts.push({ type: 'inactive', message: 'No output today' });
      }
      if (achievementPct >= 110) {
        alerts.push({ type: 'star', message: 'Star performer' });
      }
      const last5 = activeDays.slice(-5);
      if (last5.length >= 5) {
        const firstHalf = last5.slice(0, 2).reduce((a, b) => a + b.total, 0);
        const secondHalf = last5.slice(-2).reduce((a, b) => a + b.total, 0);
        if (secondHalf > firstHalf + 2) {
          alerts.push({ type: 'improving', message: 'Improving trend' });
        }
      }
      return alerts;
    }

    function calculateTeamStats(employees, workingDays, currentDay, nonWorkingInfo) {
      const total = employees.length;
      const avgAchievement = employees.reduce((a, b) => a + b.achievementPct, 0) / total;
      const onTrack = employees.filter(e => e.achievementPct >= 100).length;
      const atRisk = employees.filter(e => e.achievementPct >= 80 && e.achievementPct < 100).length;
      const critical = employees.filter(e => e.achievementPct < 80).length;
      const totalOutput = employees.reduce((a, b) => a + b.totalDone, 0);
      const totalTarget = employees.reduce((a, b) => a + b.targetRequired, 0);
      const totalRetail = employees.reduce((a, b) => a + b.totalRetail, 0);
      const totalProlinks = employees.reduce((a, b) => a + b.totalProlinks, 0);
      const totalSvg = employees.reduce((a, b) => a + b.totalSvg, 0);
      const totalRetailPending = employees.reduce((a, b) => a + b.retailPending, 0);
      const totalProlinksPending = employees.reduce((a, b) => a + b.prolinksPending, 0);
      const totalSvgPending = employees.reduce((a, b) => a + b.svgPending, 0);

      return { 
        total, avgAchievement, onTrack, atRisk, critical, totalOutput, totalTarget, 
        workingDays, currentDay, nonWorkingInfo,
        totalRetail, totalProlinks, totalSvg, totalRetailPending, totalProlinksPending, totalSvgPending
      };
    }

    function showDashboard() {
      uploadScreen.classList.add('hidden');
      dashboard.classList.remove('hidden');
      renderDashboard();
    }

    function renderDashboard() {
      document.getElementById('report-date-badge').textContent = `üìÖ ${appData.reportDate}`;
      document.getElementById('working-days-badge').textContent = `‚úÖ ${appData.workingDays} Working Days`;
      renderSummaryCards();
      renderChampion();
      renderLeaderboard();
      renderTable();
      renderFooterStats();
    }

    function renderSummaryCards() {
      const stats = appData.teamStats;
      document.getElementById('summary-cards').innerHTML = `
        <div class="bg-slate-900 border border-slate-800 rounded-xl p-4">
          <div class="text-xs uppercase tracking-wide text-gray-500 mb-1">Employees</div>
          <div class="text-2xl font-bold">${stats.total}</div>
        </div>
        <div class="bg-slate-900 border border-slate-800 rounded-xl p-4">
          <div class="text-xs uppercase tracking-wide text-gray-500 mb-1">Calendar Days</div>
          <div class="text-2xl font-bold">${stats.currentDay}</div>
        </div>
        <div class="bg-slate-900 border border-slate-800 rounded-xl p-4">
          <div class="text-xs uppercase tracking-wide text-emerald-400 mb-1">Working Days</div>
          <div class="text-2xl font-bold text-emerald-400">${stats.workingDays}</div>
          <div class="text-xs text-gray-500">${stats.nonWorkingInfo.sundays} Sun + ${stats.nonWorkingInfo.holidays} Hol</div>
        </div>
        <div class="bg-slate-900 border border-slate-800 rounded-xl p-4">
          <div class="text-xs uppercase tracking-wide text-gray-500 mb-1">Team Output</div>
          <div class="text-2xl font-bold text-cyan-400">${stats.totalOutput.toLocaleString()}</div>
        </div>
        <div class="bg-slate-900 border border-slate-800 rounded-xl p-4">
          <div class="text-xs uppercase tracking-wide text-gray-500 mb-1">Avg Achievement</div>
          <div class="text-2xl font-bold">${stats.avgAchievement.toFixed(1)}%</div>
        </div>
        <div class="bg-slate-900 border border-slate-800 rounded-xl p-4">
          <div class="text-xs uppercase tracking-wide text-emerald-400 mb-1">‚úÖ On Track</div>
          <div class="text-2xl font-bold text-emerald-400">${stats.onTrack}</div>
        </div>
        <div class="bg-slate-900 border border-slate-800 rounded-xl p-4">
          <div class="text-xs uppercase tracking-wide text-red-400 mb-1">üî¥ Critical</div>
          <div class="text-2xl font-bold text-red-400">${stats.critical}</div>
        </div>
      `;
    }

    function renderChampion() {
      const champ = appData.champion;
      document.getElementById('champion-card').innerHTML = `
        <div class="flex items-center gap-2 mb-4">
          <span class="text-3xl">üèÜ</span>
          <div>
            <div class="text-xs uppercase tracking-wide text-gray-400">Champion of the Month</div>
            <div class="text-lg font-bold">${champ?.name || 'TBD'}</div>
          </div>
        </div>
        ${champ ? `
          <div class="grid grid-cols-2 gap-4 text-sm">
            <div>
              <div class="text-gray-400">Total Output</div>
              <div class="font-bold text-lg">${champ.totalDone}</div>
            </div>
            <div>
              <div class="text-gray-400">Achievement</div>
              <div class="font-bold text-lg text-emerald-400">${champ.achievementPct.toFixed(1)}%</div>
            </div>
          </div>
        ` : ''}
      `;
    }

    function renderLeaderboard() {
      const top5 = appData.leaderboard.slice(0, 5);
      const medals = ['ü•á', 'ü•à', 'ü•â', '4Ô∏è‚É£', '5Ô∏è‚É£'];
      document.getElementById('leaderboard-card').innerHTML = `
        <div class="flex items-center gap-2 mb-4">
          <span class="text-xl">üéñÔ∏è</span>
          <div class="font-semibold">Top 5 Performers</div>
        </div>
        <div class="grid grid-cols-1 sm:grid-cols-5 gap-2">
          ${top5.map((emp, i) => `
            <div class="flex items-center gap-2 p-2 rounded-lg bg-slate-800">
              <span class="text-lg">${medals[i]}</span>
              <div class="min-w-0">
                <div class="font-medium text-sm truncate">${emp.name}</div>
                <div class="text-xs text-gray-400">${emp.achievementPct.toFixed(0)}%</div>
              </div>
            </div>
          `).join('')}
        </div>
      `;
    }

    function getFilteredEmployees() {
      let filtered = appData.employees;

      if (searchTerm) {
        filtered = filtered.filter(e => e.fullName.toLowerCase().includes(searchTerm.toLowerCase()));
      }

      if (filterStatus === 'ontrack') {
        filtered = filtered.filter(e => e.achievementPct >= 100);
      } else if (filterStatus === 'atrisk') {
        filtered = filtered.filter(e => e.achievementPct >= 80 && e.achievementPct < 100);
      } else if (filterStatus === 'critical') {
        filtered = filtered.filter(e => e.achievementPct < 80);
      } else if (filterStatus === 'star') {
        filtered = filtered.filter(e => e.alerts.some(a => a.type === 'star'));
      }

      if (sortConfig.key) {
        filtered = [...filtered].sort((a, b) => {
          let aVal = a[sortConfig.key];
          let bVal = b[sortConfig.key];
          if (typeof aVal === 'string') { aVal = aVal.toLowerCase(); bVal = bVal.toLowerCase(); }
          if (aVal < bVal) return sortConfig.direction === 'asc' ? -1 : 1;
          if (aVal > bVal) return sortConfig.direction === 'asc' ? 1 : -1;
          return 0;
        });
      }

      return filtered;
    }

    function renderTable() {
      const employees = getFilteredEmployees();
      
      const dayHeaders = [];
      for (let d = 1; d <= appData.currentDay; d++) {
        const isNonWorking = isNonWorkingDay(appData.currentYear, appData.currentMonth, d);
        const bgClass = isNonWorking ? 'bg-slate-700' : '';
        dayHeaders.push(`<th class="px-1 py-3 text-center font-semibold border-b border-slate-700 text-xs min-w-[32px] ${bgClass}">${d}</th>`);
      }
      
      document.getElementById('table-header').innerHTML = `
        <tr>
          <th class="px-4 py-3 text-left font-semibold border-b border-slate-700 cursor-pointer hover:bg-slate-700" onclick="handleSort('fullName')">
            Employee ${sortConfig.key === 'fullName' ? (sortConfig.direction === 'asc' ? '‚Üë' : '‚Üì') : ''}
          </th>
          <th class="px-3 py-3 text-center font-semibold border-b border-slate-700">Target</th>
          <th class="px-3 py-3 text-center font-semibold border-b border-slate-700">Trend</th>
          <th class="px-3 py-3 text-center font-semibold border-b border-slate-700">Alerts</th>
          ${dayHeaders.join('')}
          <th class="px-3 py-3 text-center font-semibold border-b border-slate-700 cursor-pointer hover:bg-slate-700" onclick="handleSort('totalDone')">
            Total ${sortConfig.key === 'totalDone' ? (sortConfig.direction === 'asc' ? '‚Üë' : '‚Üì') : ''}
          </th>
          <th class="px-3 py-3 text-center font-semibold border-b border-slate-700">Target Req.</th>
          <th class="px-3 py-3 text-center font-semibold border-b border-slate-700 cursor-pointer hover:bg-slate-700" onclick="handleSort('shortfall')">
            Shortfall ${sortConfig.key === 'shortfall' ? (sortConfig.direction === 'asc' ? '‚Üë' : '‚Üì') : ''}
          </th>
          <th class="px-3 py-3 text-center font-semibold border-b border-slate-700 cursor-pointer hover:bg-slate-700" onclick="handleSort('achievementPct')">
            % ${sortConfig.key === 'achievementPct' ? (sortConfig.direction === 'asc' ? '‚Üë' : '‚Üì') : ''}
          </th>
          <th class="px-3 py-3 text-center font-semibold border-b border-slate-700">Pending</th>
        </tr>
      `;

      document.getElementById('table-body').innerHTML = employees.map((emp, idx) => `
        <tr class="hover:bg-slate-800 ${idx % 2 === 0 ? '' : 'bg-slate-900/50'}">
          <td class="px-4 py-2 border-b border-slate-700">
            <div class="font-medium">${emp.name}</div>
            <div class="text-xs text-gray-500">${emp.id}</div>
          </td>
          <td class="px-3 py-2 text-center border-b border-slate-700 font-bold">${emp.dailyTarget}</td>
          <td class="px-3 py-2 text-center border-b border-slate-700">
            <span class="text-xl ${emp.trend === 'up' ? 'text-emerald-400' : emp.trend === 'down' ? 'text-red-400' : 'text-gray-400'}">
              ${emp.trend === 'up' ? '‚Üë' : emp.trend === 'down' ? '‚Üì' : '‚Üí'}
            </span>
          </td>
          <td class="px-3 py-2 text-center border-b border-slate-700">
            <div class="flex justify-center gap-1 flex-wrap">
              ${emp.alerts.map(a => `
                <span class="cursor-help" title="${a.message}">
                  ${a.type === 'critical' ? 'üî¥' : a.type === 'warning' ? '‚ö†Ô∏è' : a.type === 'inactive' ? 'üëª' : a.type === 'star' ? '‚≠ê' : 'üìà'}
                </span>
              `).join('')}
            </div>
          </td>
          ${emp.dailyData.slice(0, appData.currentDay).map(day => {
            if (day.isNonWorking) {
              const title = day.isSunday ? 'Sunday' : 'Holiday';
              return `
                <td class="px-1 py-2 text-center border-b border-slate-700" title="${title}">
                  <div class="w-7 h-7 mx-auto rounded flex items-center justify-center text-xs font-bold text-gray-300 cell-holiday">
                    H
                  </div>
                </td>
              `;
            }
            return `
              <td class="px-1 py-2 text-center border-b border-slate-700" title="Day ${day.day}: R${day.retail} P${day.prolinks} S${day.svg}">
                <div class="w-7 h-7 mx-auto rounded flex items-center justify-center text-xs font-medium text-white ${getColorClass(day.total, emp.dailyTarget)}">
                  ${day.total}
                </div>
              </td>
            `;
          }).join('')}
          <td class="px-3 py-2 text-center font-bold border-b border-slate-700 text-cyan-400">${emp.totalDone}</td>
          <td class="px-3 py-2 text-center border-b border-slate-700">${emp.targetRequired}</td>
          <td class="px-3 py-2 text-center font-bold border-b border-slate-700 ${emp.shortfall > 0 ? 'text-red-400' : 'text-emerald-400'}">
            ${emp.shortfall > 0 ? '-' + emp.shortfall : '0'}
          </td>
          <td class="px-3 py-2 text-center border-b border-slate-700">
            <div class="flex items-center justify-center gap-2">
              <div class="w-16 h-2 rounded-full bg-slate-700 overflow-hidden">
                <div class="h-full rounded-full ${emp.achievementPct >= 100 ? 'bg-emerald-500' : emp.achievementPct >= 80 ? 'bg-amber-500' : 'bg-red-500'}" style="width: ${Math.min(100, emp.achievementPct)}%"></div>
              </div>
              <span class="font-bold ${emp.achievementPct >= 100 ? 'text-emerald-400' : emp.achievementPct >= 80 ? 'text-amber-400' : 'text-red-400'}">
                ${emp.achievementPct.toFixed(0)}%
              </span>
            </div>
          </td>
          <td class="px-3 py-2 text-center border-b border-slate-700 text-gray-400">${emp.totalPending}</td>
        </tr>
      `).join('');
    }

    function getColorClass(total, target) {
      if (target === 10) {
        if (total >= 10) return 'cell-green';
        if (total >= 8) return 'cell-yellow';
        return 'cell-red';
      } else {
        if (total >= 8) return 'cell-green';
        if (total >= 6) return 'cell-yellow';
        return 'cell-red';
      }
    }

    function handleSort(key) {
      if (sortConfig.key === key) {
        sortConfig.direction = sortConfig.direction === 'asc' ? 'desc' : 'asc';
      } else {
        sortConfig.key = key;
        sortConfig.direction = 'asc';
      }
      renderTable();
    }

    function renderFooterStats() {
      const stats = appData.teamStats;
      const total = stats.totalRetail + stats.totalProlinks + stats.totalSvg;
      const employees = appData.employees;

      document.getElementById('footer-stats').innerHTML = `
        <div class="bg-slate-900 border border-slate-800 rounded-xl p-4">
          <div class="font-semibold mb-3">üìä Team Work Breakdown</div>
          <div class="space-y-3">
            <div>
              <div class="flex justify-between text-sm mb-1">
                <span>Retail</span>
                <span>${stats.totalRetail} (${total > 0 ? (stats.totalRetail/total*100).toFixed(1) : 0}%)</span>
              </div>
              <div class="h-2 rounded-full bg-slate-700">
                <div class="h-full rounded-full bg-blue-500" style="width: ${total > 0 ? stats.totalRetail/total*100 : 0}%"></div>
              </div>
            </div>
            <div>
              <div class="flex justify-between text-sm mb-1">
                <span>Prolinks</span>
                <span>${stats.totalProlinks} (${total > 0 ? (stats.totalProlinks/total*100).toFixed(1) : 0}%)</span>
              </div>
              <div class="h-2 rounded-full bg-slate-700">
                <div class="h-full rounded-full bg-purple-500" style="width: ${total > 0 ? stats.totalProlinks/total*100 : 0}%"></div>
              </div>
            </div>
            <div>
              <div class="flex justify-between text-sm mb-1">
                <span>SVG</span>
                <span>${stats.totalSvg} (${total > 0 ? (stats.totalSvg/total*100).toFixed(1) : 0}%)</span>
              </div>
              <div class="h-2 rounded-full bg-slate-700">
                <div class="h-full rounded-full bg-teal-500" style="width: ${total > 0 ? stats.totalSvg/total*100 : 0}%"></div>
              </div>
            </div>
          </div>
        </div>

        <div class="bg-slate-900 border border-slate-800 rounded-xl p-4">
          <div class="font-semibold mb-3">üìã Pending Work Summary</div>
          <div class="space-y-2">
            <div class="flex justify-between">
              <span class="text-gray-400">Total Retail Pending</span>
              <span class="font-bold">${stats.totalRetailPending}</span>
            </div>
            <div class="flex justify-between">
              <span class="text-gray-400">Total Prolinks Pending</span>
              <span class="font-bold">${stats.totalProlinksPending}</span>
            </div>
            <div class="flex justify-between">
              <span class="text-gray-400">Total SVG Pending</span>
              <span class="font-bold">${stats.totalSvgPending}</span>
            </div>
            <div class="pt-2 mt-2 border-t border-slate-700 flex justify-between">
              <span class="font-semibold">Total Backlog</span>
              <span class="font-bold text-amber-400">${stats.totalRetailPending + stats.totalProlinksPending + stats.totalSvgPending}</span>
            </div>
          </div>
        </div>

        <div class="bg-slate-900 border border-slate-800 rounded-xl p-4">
          <div class="font-semibold mb-3">üìà Performance Distribution</div>
          <div class="space-y-2">
            <div class="flex justify-between items-center">
              <span class="text-emerald-400">Exceeding (‚â•110%)</span>
              <span class="font-bold">${employees.filter(e => e.achievementPct >= 110).length}</span>
            </div>
            <div class="flex justify-between items-center">
              <span class="text-emerald-400">On Track (100-109%)</span>
              <span class="font-bold">${employees.filter(e => e.achievementPct >= 100 && e.achievementPct < 110).length}</span>
            </div>
            <div class="flex justify-between items-center">
              <span class="text-amber-400">At Risk (80-99%)</span>
              <span class="font-bold">${employees.filter(e => e.achievementPct >= 80 && e.achievementPct < 100).length}</span>
            </div>
            <div class="flex justify-between items-center">
              <span class="text-red-400">Critical (&lt;80%)</span>
              <span class="font-bold">${employees.filter(e => e.achievementPct < 80).length}</span>
            </div>
          </div>
        </div>
      `;
    }

    function toggleTheme() {
      darkMode = !darkMode;
      document.body.classList.toggle('light-mode');
      if (darkMode) {
        document.body.classList.remove('bg-gray-50', 'text-gray-900');
        document.body.classList.add('bg-slate-950', 'text-gray-100');
        document.getElementById('theme-toggle').textContent = '‚òÄÔ∏è';
      } else {
        document.body.classList.remove('bg-slate-950', 'text-gray-100');
        document.body.classList.add('bg-gray-50', 'text-gray-900');
        document.getElementById('theme-toggle').textContent = 'üåô';
      }
    }

    function toggleFullscreen() {
      if (!document.fullscreenElement) {
        document.documentElement.requestFullscreen();
      } else {
        document.exitFullscreen();
      }
    }

    function resetApp() {
      appData = null;
      searchTerm = '';
      filterStatus = 'all';
      sortConfig = { key: null, direction: 'asc' };
      searchInput.value = '';
      filterSelect.value = 'all';
      dashboard.classList.add('hidden');
      uploadScreen.classList.remove('hidden');
    }
  </script>
</body>
</html>
